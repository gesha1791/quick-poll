# <a href="http://git.foxminded.com.ua/gesha17/quick-poll">Chapter 8</a>

#### 1. Как настроена секьюрити и как работает OAuth2? Основные компоненты security: AuthenticationManager, UserDetailsService, SecurityContextHolder и тд
Запрашиваемый защищенный ресурс в веб приложении. Запрос проходит цепочку фильтров, которые идентифицирует AuthenticationEntryPoint. AuthenticationEntryPoint отвечает клиенту запросом на аутентификацию, например путем отправки юзеру страницы входа. Создается объект authentication , при помощи информации полученной от пользователя (user, password). Этот интерфейс представляет токен для аутентификации или полностью аутентифицированного юзера. Дальше AuthenticationManager, в котором содержится метод authenticate, принимает токен запроса и возвращает полностью заполненную аутентификацию. В spring готовая реалицзация AuthenticationManager, предоставляется ProviderManager. Дальше ProviderManager должен сравнить предоставленную информацию о пользователе с данными с БД. Для этого мы имплементим UserDetailsService в котором есть метод loadUserByUsername, который получает данные о пользователе с БД. AuthenticationProvider сранивает значение и создает полностью созданный заполненный экземпляр Authentication. Затем этот экземпляр перемещается в контекст SecurityContextHolder. Затем SpringSecurity выполняет проверку авторизации используя перехватчики. AbstractSecurityInterceptor полагается на конфигурацию безопасности, что бы  решать авторизован пользователь или нет. Если да, то дает доступ до защищенного ресурса.
В нашем приложении реализовано два вида защиты Base и OAuth2.
Для начала нужно зарегестрироваться на сервере авторизации. При успешной регистрации клиент получит Client ID и Client secret. Client ID используется для идентификации клиента.
Клиент запрашивает авторизацию для доступа к защищенным ресурсам от имени пользователя и перенаправляет владельца ресурсов на сервер авторизации. Идентификатор клиента представляет собой публично доступную строку, которая используется API сервиса для идентификации приложения, а также используется для создания авторизованных URL для пользователей. Секрет клиента используется для аутентификации подлинности приложения для API сервиса, когда приложение запрашивает доступ к аккаунту пользователя. При получении запроса сервер авторизации предоставит пользователю проверку подлинности, обычно через вход в систему (логин и пароль). При успешной проверке данных, сервер авторизации
перенаправляет пользователя в клиентское приложение, используя параметр CALL_BACK_URI. Сервер авторизации также добавляет код авторизации в CALL_BACK_URI.
Затем клиент использует код авторизации для запроса токена доступа с сервера авторизации. Сервер авторизации проверяет личность клиента и код авторизации. При успешной проверке возвращает токен доступа в формате Json. Получив токен доступа, клиент будет запрашивать защищенный ресурс с сервера ресурсов, передавая полученный токен доступа. Сервер ресурсов проверяет токен доступа и обслуживает защищенный ресурс.
#### 2. Вот у тебя `.resourceIds("QuickPoll_Resources");` для чего?
Это идентификатор ресурса. Это строка которая представляет набор ресурсов к которым клиент может запросить доступ.